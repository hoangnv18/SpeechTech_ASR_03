import os
import torch
from transformers import WhisperForConditionalGeneration, WhisperProcessor
from transformers import WhisperProcessor, WhisperForConditionalGeneration
import torch
import torchaudio
import tqdm

path_model="./dataset/checkpoint-10000"
# Load model và processor
model = WhisperForConditionalGeneration.from_pretrained(path_model)
processor = WhisperProcessor.from_pretrained("openai/whisper-large-v3", language="vi", task="transcribe")

# model.generation_config.forced_decoder_ids = None

# Xác định forced_decoder_ids tương ứng với ngôn ngữ và tác vụ
forced_decoder_ids = processor.get_decoder_prompt_ids(language="vi", task="transcribe")
# Gán vào model
model.generation_config.forced_decoder_ids = forced_decoder_ids


model.eval()

def transcribe(audio_path):
    # Load file âm thanh (mp3, wav, v.v...)
    speech_array, sampling_rate = torchaudio.load(audio_path)

    # Nếu tần số mẫu khác 16000Hz, resample về 16kHz
    if sampling_rate != 16000:
        speech_array = torchaudio.functional.resample(speech_array, sampling_rate, 16000)
        sampling_rate = 16000

    # Xử lý với processor
    inputs = processor(speech_array.squeeze().numpy(), sampling_rate=sampling_rate, return_tensors="pt")

    # Đưa model và input lên GPU nếu có
    if torch.cuda.is_available():
        model.to("cuda")
        inputs = {k: v.to("cuda") for k, v in inputs.items()}

    # Dự đoán
    with torch.no_grad():
        predicted_ids = model.generate(inputs["input_features"])

    # Giải mã output
    transcription = processor.batch_decode(predicted_ids, skip_special_tokens=True)[0]
    return transcription

list_namefile = ['VIVOSDEV02_R106', 'VIVOSDEV02_R122', 'VIVOSDEV02_R130', 'VIVOSDEV02_R132', 'VIVOSDEV02_R135', 'VIVOSDEV02_R137', 'VIVOSDEV02_R149', 'VIVOSDEV02_R154', 'VIVOSDEV02_R015', 'VIVOSDEV02_R164', 'VIVOSDEV02_R170', 'VIVOSDEV02_R173', 'VIVOSDEV02_R181', 'VIVOSDEV02_R192', 'VIVOSDEV02_R195', 'VIVOSDEV02_R200', 'VIVOSDEV02_R027', 'VIVOSDEV02_R031', 'VIVOSDEV02_R032', 'VIVOSDEV02_R045', 'VIVOSDEV02_R005', 'VIVOSDEV02_R067', 'VIVOSDEV02_R068', 'VIVOSDEV02_R069', 'VIVOSDEV02_R071', 'VIVOSDEV02_R076', 'VIVOSDEV02_R079', 'VIVOSDEV02_R087', 'VIVOSDEV02_R089', 'VIVOSDEV02_R091', 'VIVOSDEV02_R099', 'VIVOSDEV02_R009', 'VIVOSDEV02_T012', 'VIVOSDEV02_T013', 'VIVOSDEV02_T015', 'VIVOSDEV02_T022', 'VIVOSDEV02_T031', 'VIVOSDEV02_T043', 'VIVOSDEV02_T004', 'VIVOSDEV02_T050', 'VIVOSDEV03_R109', 'VIVOSDEV03_R010', 'VIVOSDEV03_R113', 'VIVOSDEV03_R117', 'VIVOSDEV03_R119', 'VIVOSDEV03_R120', 'VIVOSDEV03_R125', 'VIVOSDEV03_R136', 'VIVOSDEV03_R142', 'VIVOSDEV03_R144', 'VIVOSDEV03_R148', 'VIVOSDEV03_R149', 'VIVOSDEV03_R156', 'VIVOSDEV03_R160', 'VIVOSDEV03_R163', 'VIVOSDEV03_R180', 'VIVOSDEV03_R182', 'VIVOSDEV03_R191', 'VIVOSDEV03_R193', 'VIVOSDEV03_R195', 'VIVOSDEV03_R198', 'VIVOSDEV03_R020', 'VIVOSDEV03_R029', 'VIVOSDEV03_R041', 'VIVOSDEV03_R044', 'VIVOSDEV03_R046', 'VIVOSDEV03_R056', 'VIVOSDEV03_R057', 'VIVOSDEV03_R061', 'VIVOSDEV03_R007', 'VIVOSDEV03_R082', 'VIVOSDEV03_R092', 'VIVOSDEV03_T017', 'VIVOSDEV03_T018', 'VIVOSDEV03_T023', 'VIVOSDEV03_T035', 'VIVOSDEV03_T041', 'VIVOSDEV03_T047', 'VIVOSDEV03_T048', 'VIVOSDEV03_T009', 'VIVOSDEV01_R108', 'VIVOSDEV01_R117', 'VIVOSDEV01_R012', 'VIVOSDEV01_R130', 'VIVOSDEV01_R139', 'VIVOSDEV01_R141', 'VIVOSDEV01_R146', 'VIVOSDEV01_R150', 'VIVOSDEV01_R151', 'VIVOSDEV01_R164', 'VIVOSDEV01_R170', 'VIVOSDEV01_R172', 'VIVOSDEV01_R174', 'VIVOSDEV01_R176', 'VIVOSDEV01_R180', 'VIVOSDEV01_R187', 'VIVOSDEV01_R188', 'VIVOSDEV01_R027', 'VIVOSDEV01_R028', 'VIVOSDEV01_R002', 'VIVOSDEV01_R034', 'VIVOSDEV01_R003', 'VIVOSDEV01_R043', 'VIVOSDEV01_R044', 'VIVOSDEV01_R055', 'VIVOSDEV01_R057', 'VIVOSDEV01_R058', 'VIVOSDEV01_R069', 'VIVOSDEV01_R071', 'VIVOSDEV01_R078', 'VIVOSDEV01_R086', 'VIVOSDEV01_R089', 'VIVOSDEV01_R092', 'VIVOSDEV01_R098', 'VIVOSDEV01_R099', 'VIVOSDEV01_T002', 'VIVOSDEV01_T030', 'VIVOSDEV01_T038', 'VIVOSDEV01_T043', 'VIVOSDEV01_T048', 'VIVOSDEV04_R100', 'VIVOSDEV04_R010', 'VIVOSDEV04_R114', 'VIVOSDEV04_R118', 'VIVOSDEV04_R126', 'VIVOSDEV04_R127', 'VIVOSDEV04_R129', 'VIVOSDEV04_R132', 'VIVOSDEV04_R013', 'VIVOSDEV04_R149', 'VIVOSDEV04_R152', 'VIVOSDEV04_R162', 'VIVOSDEV04_R182', 'VIVOSDEV04_R186', 'VIVOSDEV04_R187', 'VIVOSDEV04_R189', 'VIVOSDEV04_R023', 'VIVOSDEV04_R002', 'VIVOSDEV04_R047', 'VIVOSDEV04_R049', 'VIVOSDEV04_R004', 'VIVOSDEV04_R051', 'VIVOSDEV04_R056', 'VIVOSDEV04_R063', 'VIVOSDEV04_R081', 'VIVOSDEV04_R086', 'VIVOSDEV04_R089', 'VIVOSDEV04_R008', 'VIVOSDEV04_R092', 'VIVOSDEV04_R095', 'VIVOSDEV04_R097', 'VIVOSDEV04_T015', 'VIVOSDEV04_T018', 'VIVOSDEV04_T029', 'VIVOSDEV04_T002', 'VIVOSDEV04_T032', 'VIVOSDEV04_T035', 'VIVOSDEV04_T003', 'VIVOSDEV04_T044', 'VIVOSDEV04_T009', 'VIVOSDEV05_004', 'VIVOSDEV05_030', 'VIVOSDEV05_037', 'VIVOSDEV05_043', 'VIVOSDEV05_055', 'VIVOSDEV05_065', 'VIVOSDEV05_087', 'VIVOSDEV05_091', 'VIVOSDEV05_097', 'VIVOSDEV05_107', 'VIVOSDEV05_109', 'VIVOSDEV05_115', 'VIVOSDEV05_119', 'VIVOSDEV05_120', 'VIVOSDEV05_125', 'VIVOSDEV05_129', 'VIVOSDEV05_135', 'VIVOSDEV05_136', 'VIVOSDEV05_143', 'VIVOSDEV05_150', 'VIVOSDEV05_155', 'VIVOSDEV05_170', 'VIVOSDEV05_185', 'VIVOSDEV05_189', 'VIVOSDEV05_199', 'VIVOSDEV05_200', 'VIVOSDEV05_202', 'VIVOSDEV05_206', 'VIVOSDEV05_209', 'VIVOSDEV05_212', 'VIVOSDEV05_226', 'VIVOSDEV05_231', 'VIVOSDEV05_238', 'VIVOSDEV05_249', 'VIVOSDEV05_251', 'VIVOSDEV05_261', 'VIVOSDEV05_263', 'VIVOSDEV05_270', 'VIVOSDEV05_286', 'VIVOSDEV05_295', 'VIVOSDEV06_001', 'VIVOSDEV06_006', 'VIVOSDEV06_016', 'VIVOSDEV06_021', 'VIVOSDEV06_022', 'VIVOSDEV06_034', 'VIVOSDEV06_037', 'VIVOSDEV06_040', 'VIVOSDEV06_042', 'VIVOSDEV06_054', 'VIVOSDEV06_061', 'VIVOSDEV06_070', 'VIVOSDEV06_078', 'VIVOSDEV06_079', 'VIVOSDEV06_098', 'VIVOSDEV06_103', 'VIVOSDEV06_108', 'VIVOSDEV06_117', 'VIVOSDEV06_126', 'VIVOSDEV06_139', 'VIVOSDEV06_143', 'VIVOSDEV06_157', 'VIVOSDEV06_168', 'VIVOSDEV06_184', 'VIVOSDEV06_195', 'VIVOSDEV06_210', 'VIVOSDEV06_212', 'VIVOSDEV06_222', 'VIVOSDEV06_240', 'VIVOSDEV06_241', 'VIVOSDEV06_247', 'VIVOSDEV06_248', 'VIVOSDEV06_252', 'VIVOSDEV06_253', 'VIVOSDEV06_261', 'VIVOSDEV06_272', 'VIVOSDEV06_285', 'VIVOSDEV06_286', 'VIVOSDEV06_287', 'VIVOSDEV06_296', 'VIVOSDEV07_002', 'VIVOSDEV07_025', 'VIVOSDEV07_030', 'VIVOSDEV07_036', 'VIVOSDEV07_039', 'VIVOSDEV07_044', 'VIVOSDEV07_045', 'VIVOSDEV07_064', 'VIVOSDEV07_066', 'VIVOSDEV07_067', 'VIVOSDEV07_084', 'VIVOSDEV07_093', 'VIVOSDEV07_098', 'VIVOSDEV07_107', 'VIVOSDEV07_115', 'VIVOSDEV07_125', 'VIVOSDEV07_127', 'VIVOSDEV07_134', 'VIVOSDEV07_138', 'VIVOSDEV07_141', 'VIVOSDEV07_151', 'VIVOSDEV07_156', 'VIVOSDEV07_168', 'VIVOSDEV07_170', 'VIVOSDEV07_182', 'VIVOSDEV07_185', 'VIVOSDEV07_190', 'VIVOSDEV07_192', 'VIVOSDEV07_194', 'VIVOSDEV07_195', 'VIVOSDEV07_197', 'VIVOSDEV07_209', 'VIVOSDEV07_211', 'VIVOSDEV07_223', 'VIVOSDEV07_231', 'VIVOSDEV07_236', 'VIVOSDEV07_246', 'VIVOSDEV07_264', 'VIVOSDEV07_266', 'VIVOSDEV07_295', 'VIVOSDEV08_002', 'VIVOSDEV08_005', 'VIVOSDEV08_014', 'VIVOSDEV08_025', 'VIVOSDEV08_032', 'VIVOSDEV08_053', 'VIVOSDEV08_057', 'VIVOSDEV08_062', 'VIVOSDEV08_071', 'VIVOSDEV08_077', 'VIVOSDEV08_085', 'VIVOSDEV08_090', 'VIVOSDEV08_093', 'VIVOSDEV08_100', 'VIVOSDEV08_127', 'VIVOSDEV08_128', 'VIVOSDEV08_129', 'VIVOSDEV08_141', 'VIVOSDEV08_143', 'VIVOSDEV08_145', 'VIVOSDEV08_159', 'VIVOSDEV08_163', 'VIVOSDEV08_166', 'VIVOSDEV08_180', 'VIVOSDEV08_182', 'VIVOSDEV08_193', 'VIVOSDEV08_196', 'VIVOSDEV08_201', 'VIVOSDEV08_208', 'VIVOSDEV08_210', 'VIVOSDEV08_214', 'VIVOSDEV08_222', 'VIVOSDEV08_224', 'VIVOSDEV08_233', 'VIVOSDEV08_270', 'VIVOSDEV08_271', 'VIVOSDEV08_274', 'VIVOSDEV08_277', 'VIVOSDEV08_295', 'VIVOSDEV08_300', 'VIVOSDEV09_015', 'VIVOSDEV09_022', 'VIVOSDEV09_029', 'VIVOSDEV09_035', 'VIVOSDEV09_038', 'VIVOSDEV09_039', 'VIVOSDEV09_041', 'VIVOSDEV09_047', 'VIVOSDEV09_055', 'VIVOSDEV09_077', 'VIVOSDEV09_081', 'VIVOSDEV09_083', 'VIVOSDEV09_091', 'VIVOSDEV09_098', 'VIVOSDEV09_106', 'VIVOSDEV09_110', 'VIVOSDEV09_134', 'VIVOSDEV09_139', 'VIVOSDEV09_142', 'VIVOSDEV09_144', 'VIVOSDEV09_158', 'VIVOSDEV09_159', 'VIVOSDEV09_163', 'VIVOSDEV09_166', 'VIVOSDEV09_168', 'VIVOSDEV09_178', 'VIVOSDEV09_194', 'VIVOSDEV09_198', 'VIVOSDEV09_203', 'VIVOSDEV09_204', 'VIVOSDEV09_222', 'VIVOSDEV09_246', 'VIVOSDEV09_267', 'VIVOSDEV09_268', 'VIVOSDEV09_280', 'VIVOSDEV09_286', 'VIVOSDEV09_288', 'VIVOSDEV09_289', 'VIVOSDEV09_293', 'VIVOSDEV09_297', 'VIVOSDEV10_010', 'VIVOSDEV10_014', 'VIVOSDEV10_017', 'VIVOSDEV10_020', 'VIVOSDEV10_024', 'VIVOSDEV10_030', 'VIVOSDEV10_035', 'VIVOSDEV10_043', 'VIVOSDEV10_045', 'VIVOSDEV10_051', 'VIVOSDEV10_067', 'VIVOSDEV10_068', 'VIVOSDEV10_072', 'VIVOSDEV10_073', 'VIVOSDEV10_076', 'VIVOSDEV10_090', 'VIVOSDEV10_117', 'VIVOSDEV10_129', 'VIVOSDEV10_130', 'VIVOSDEV10_140', 'VIVOSDEV10_156', 'VIVOSDEV10_162', 'VIVOSDEV10_172', 'VIVOSDEV10_176', 'VIVOSDEV10_189', 'VIVOSDEV10_194', 'VIVOSDEV10_196', 'VIVOSDEV10_211', 'VIVOSDEV10_212', 'VIVOSDEV10_227', 'VIVOSDEV10_234', 'VIVOSDEV10_239', 'VIVOSDEV10_245', 'VIVOSDEV10_247', 'VIVOSDEV10_249', 'VIVOSDEV10_257', 'VIVOSDEV10_262', 'VIVOSDEV10_266', 'VIVOSDEV10_278', 'VIVOSDEV10_294', 'VIVOSDEV11_015', 'VIVOSDEV11_022', 'VIVOSDEV11_033', 'VIVOSDEV11_036', 'VIVOSDEV11_038', 'VIVOSDEV11_046', 'VIVOSDEV11_048', 'VIVOSDEV11_057', 'VIVOSDEV11_063', 'VIVOSDEV11_075', 'VIVOSDEV11_076', 'VIVOSDEV11_077', 'VIVOSDEV11_079', 'VIVOSDEV11_081', 'VIVOSDEV11_083', 'VIVOSDEV11_095', 'VIVOSDEV11_122', 'VIVOSDEV11_123', 'VIVOSDEV11_129', 'VIVOSDEV11_131', 'VIVOSDEV11_136', 'VIVOSDEV11_137', 'VIVOSDEV11_147', 'VIVOSDEV11_160', 'VIVOSDEV11_164', 'VIVOSDEV11_182', 'VIVOSDEV11_193', 'VIVOSDEV11_198', 'VIVOSDEV11_200', 'VIVOSDEV11_234', 'VIVOSDEV11_242', 'VIVOSDEV11_246', 'VIVOSDEV11_252', 'VIVOSDEV11_262', 'VIVOSDEV11_269', 'VIVOSDEV11_273', 'VIVOSDEV11_274', 'VIVOSDEV11_282', 'VIVOSDEV11_289', 'VIVOSDEV11_298', 'VIVOSDEV12_006', 'VIVOSDEV12_011', 'VIVOSDEV12_015', 'VIVOSDEV12_032', 'VIVOSDEV12_054', 'VIVOSDEV12_056', 'VIVOSDEV12_057', 'VIVOSDEV12_065', 'VIVOSDEV12_066', 'VIVOSDEV12_068', 'VIVOSDEV12_071', 'VIVOSDEV12_075', 'VIVOSDEV12_076', 'VIVOSDEV12_079', 'VIVOSDEV12_080', 'VIVOSDEV12_100', 'VIVOSDEV12_101', 'VIVOSDEV12_116', 'VIVOSDEV12_128', 'VIVOSDEV12_132', 'VIVOSDEV12_135', 'VIVOSDEV12_144', 'VIVOSDEV12_166', 'VIVOSDEV12_169', 'VIVOSDEV12_173', 'VIVOSDEV12_182', 'VIVOSDEV12_186', 'VIVOSDEV12_192', 'VIVOSDEV12_197', 'VIVOSDEV12_213', 'VIVOSDEV12_223', 'VIVOSDEV12_224', 'VIVOSDEV12_227', 'VIVOSDEV12_232', 'VIVOSDEV12_244', 'VIVOSDEV12_248', 'VIVOSDEV12_271', 'VIVOSDEV12_275', 'VIVOSDEV12_280', 'VIVOSDEV12_290', 'VIVOSDEV13_019', 'VIVOSDEV13_026', 'VIVOSDEV13_054', 'VIVOSDEV13_058', 'VIVOSDEV13_061', 'VIVOSDEV13_069', 'VIVOSDEV13_075', 'VIVOSDEV13_078', 'VIVOSDEV13_088', 'VIVOSDEV13_089', 'VIVOSDEV13_097', 'VIVOSDEV13_098', 'VIVOSDEV13_104', 'VIVOSDEV13_105', 'VIVOSDEV13_106', 'VIVOSDEV13_136', 'VIVOSDEV13_137', 'VIVOSDEV13_139', 'VIVOSDEV13_146', 'VIVOSDEV13_147', 'VIVOSDEV13_150', 'VIVOSDEV13_164', 'VIVOSDEV13_167', 'VIVOSDEV13_210', 'VIVOSDEV13_211', 'VIVOSDEV13_222', 'VIVOSDEV13_225', 'VIVOSDEV13_226', 'VIVOSDEV13_227', 'VIVOSDEV13_230', 'VIVOSDEV13_239', 'VIVOSDEV13_241', 'VIVOSDEV13_252', 'VIVOSDEV13_255', 'VIVOSDEV13_257', 'VIVOSDEV13_258', 'VIVOSDEV13_263', 'VIVOSDEV13_267', 'VIVOSDEV13_276', 'VIVOSDEV13_277', 'VIVOSDEV14_018', 'VIVOSDEV14_022', 'VIVOSDEV14_027', 'VIVOSDEV14_035', 'VIVOSDEV14_079', 'VIVOSDEV14_080', 'VIVOSDEV14_085', 'VIVOSDEV14_086', 'VIVOSDEV14_093', 'VIVOSDEV14_104', 'VIVOSDEV14_108', 'VIVOSDEV14_113', 'VIVOSDEV14_114', 'VIVOSDEV14_115', 'VIVOSDEV14_116', 'VIVOSDEV14_123', 'VIVOSDEV14_134', 'VIVOSDEV14_140', 'VIVOSDEV14_145', 'VIVOSDEV14_151', 'VIVOSDEV14_156', 'VIVOSDEV14_163', 'VIVOSDEV14_180', 'VIVOSDEV14_186', 'VIVOSDEV14_191', 'VIVOSDEV14_194', 'VIVOSDEV14_195', 'VIVOSDEV14_199', 'VIVOSDEV14_225', 'VIVOSDEV14_227', 'VIVOSDEV14_235', 'VIVOSDEV14_236', 'VIVOSDEV14_256', 'VIVOSDEV14_280', 'VIVOSDEV14_283', 'VIVOSDEV14_285', 'VIVOSDEV14_286', 'VIVOSDEV14_289', 'VIVOSDEV14_291', 'VIVOSDEV14_294', 'VIVOSDEV15_003', 'VIVOSDEV15_013', 'VIVOSDEV15_014', 'VIVOSDEV15_020', 'VIVOSDEV15_021', 'VIVOSDEV15_026', 'VIVOSDEV15_037', 'VIVOSDEV15_038', 'VIVOSDEV15_047', 'VIVOSDEV15_050', 'VIVOSDEV15_062', 'VIVOSDEV15_066', 'VIVOSDEV15_092', 'VIVOSDEV15_109', 'VIVOSDEV15_111', 'VIVOSDEV15_117', 'VIVOSDEV15_121', 'VIVOSDEV15_137', 'VIVOSDEV15_147', 'VIVOSDEV15_154', 'VIVOSDEV15_168', 'VIVOSDEV15_173', 'VIVOSDEV15_180', 'VIVOSDEV15_194', 'VIVOSDEV15_198', 'VIVOSDEV15_200', 'VIVOSDEV15_203', 'VIVOSDEV15_204', 'VIVOSDEV15_208', 'VIVOSDEV15_209', 'VIVOSDEV15_213', 'VIVOSDEV15_216', 'VIVOSDEV15_220', 'VIVOSDEV15_239', 'VIVOSDEV15_253', 'VIVOSDEV15_255', 'VIVOSDEV15_265', 'VIVOSDEV15_267', 'VIVOSDEV15_271', 'VIVOSDEV15_299', 'VIVOSDEV16_026', 'VIVOSDEV16_033', 'VIVOSDEV16_048', 'VIVOSDEV16_049', 'VIVOSDEV16_050', 'VIVOSDEV16_051', 'VIVOSDEV16_058', 'VIVOSDEV16_059', 'VIVOSDEV16_064', 'VIVOSDEV16_067', 'VIVOSDEV16_068', 'VIVOSDEV16_074', 'VIVOSDEV16_079', 'VIVOSDEV16_101', 'VIVOSDEV16_112', 'VIVOSDEV16_120', 'VIVOSDEV16_149', 'VIVOSDEV16_153', 'VIVOSDEV16_154', 'VIVOSDEV16_161', 'VIVOSDEV16_168', 'VIVOSDEV16_173', 'VIVOSDEV16_175', 'VIVOSDEV16_177', 'VIVOSDEV16_182', 'VIVOSDEV16_193', 'VIVOSDEV16_196', 'VIVOSDEV16_197', 'VIVOSDEV16_198', 'VIVOSDEV16_203', 'VIVOSDEV16_228', 'VIVOSDEV16_233', 'VIVOSDEV16_239', 'VIVOSDEV16_247', 'VIVOSDEV16_266', 'VIVOSDEV16_267', 'VIVOSDEV16_273', 'VIVOSDEV16_279', 'VIVOSDEV16_298', 'VIVOSDEV16_299', 'VIVOSDEV17_011', 'VIVOSDEV17_024', 'VIVOSDEV17_032', 'VIVOSDEV17_043', 'VIVOSDEV17_048', 'VIVOSDEV17_060', 'VIVOSDEV17_062', 'VIVOSDEV17_070', 'VIVOSDEV17_071', 'VIVOSDEV17_077', 'VIVOSDEV17_090', 'VIVOSDEV17_099', 'VIVOSDEV17_100', 'VIVOSDEV17_107', 'VIVOSDEV17_109', 'VIVOSDEV17_114', 'VIVOSDEV17_120', 'VIVOSDEV17_133', 'VIVOSDEV17_147', 'VIVOSDEV17_169', 'VIVOSDEV17_170', 'VIVOSDEV17_173', 'VIVOSDEV17_181', 'VIVOSDEV17_189', 'VIVOSDEV17_192', 'VIVOSDEV17_204', 'VIVOSDEV17_208', 'VIVOSDEV17_212', 'VIVOSDEV17_213', 'VIVOSDEV17_217', 'VIVOSDEV17_239', 'VIVOSDEV17_241', 'VIVOSDEV17_245', 'VIVOSDEV17_254', 'VIVOSDEV17_268', 'VIVOSDEV17_271', 'VIVOSDEV17_285', 'VIVOSDEV17_288', 'VIVOSDEV17_297', 'VIVOSDEV17_299', 'VIVOSDEV18_006', 'VIVOSDEV18_012', 'VIVOSDEV18_017', 'VIVOSDEV18_021', 'VIVOSDEV18_051', 'VIVOSDEV18_056', 'VIVOSDEV18_060', 'VIVOSDEV18_064', 'VIVOSDEV18_065', 'VIVOSDEV18_082', 'VIVOSDEV18_102', 'VIVOSDEV18_114', 'VIVOSDEV18_118', 'VIVOSDEV18_120', 'VIVOSDEV18_126', 'VIVOSDEV18_155', 'VIVOSDEV18_171', 'VIVOSDEV18_183', 'VIVOSDEV18_191', 'VIVOSDEV18_192', 'VIVOSDEV18_194', 'VIVOSDEV18_195', 'VIVOSDEV18_198', 'VIVOSDEV18_199', 'VIVOSDEV18_211', 'VIVOSDEV18_214', 'VIVOSDEV18_240', 'VIVOSDEV18_250', 'VIVOSDEV18_252', 'VIVOSDEV18_257', 'VIVOSDEV18_259', 'VIVOSDEV18_263', 'VIVOSDEV18_265', 'VIVOSDEV18_272', 'VIVOSDEV18_273', 'VIVOSDEV18_279', 'VIVOSDEV18_280', 'VIVOSDEV18_282', 'VIVOSDEV18_293', 'VIVOSDEV18_297', 'VIVOSDEV19_008', 'VIVOSDEV19_011', 'VIVOSDEV19_020', 'VIVOSDEV19_022', 'VIVOSDEV19_024', 'VIVOSDEV19_027', 'VIVOSDEV19_029', 'VIVOSDEV19_030', 'VIVOSDEV19_045', 'VIVOSDEV19_056', 'VIVOSDEV19_061', 'VIVOSDEV19_064', 'VIVOSDEV19_071', 'VIVOSDEV19_072', 'VIVOSDEV19_083', 'VIVOSDEV19_091', 'VIVOSDEV19_094', 'VIVOSDEV19_111', 'VIVOSDEV19_133', 'VIVOSDEV19_142', 'VIVOSDEV19_158', 'VIVOSDEV19_161', 'VIVOSDEV19_163', 'VIVOSDEV19_167', 'VIVOSDEV19_169', 'VIVOSDEV19_179', 'VIVOSDEV19_196', 'VIVOSDEV19_218', 'VIVOSDEV19_222', 'VIVOSDEV19_227', 'VIVOSDEV19_244', 'VIVOSDEV19_245', 'VIVOSDEV19_246', 'VIVOSDEV19_249', 'VIVOSDEV19_257', 'VIVOSDEV19_259', 'VIVOSDEV19_262', 'VIVOSDEV19_266', 'VIVOSDEV19_274', 'VIVOSDEV19_279']

public_test_dir = "./dataset/public_test/vivos/test/waves"

list_publictest_path = []
for namefile in list_namefile:
  namefolder = namefile.split("_")[0]

  audio_file = "{}/{}/{}.wav".format(public_test_dir,
                                     namefolder,
                                     namefile)
  list_publictest_path.append(audio_file)

print(list_publictest_path)


text = ""

for audio_file in tqdm.tqdm(list_publictest_path):
  result = transcribe(audio_file).lstrip()
  text += result + "\n"
with open("transcripts.txt", "w") as f:
     f.write(text[:-1])

os.system("zip -r transcripts.zip transcripts.txt")
